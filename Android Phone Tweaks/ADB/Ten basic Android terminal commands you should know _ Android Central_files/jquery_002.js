(function(e){e.cluetip={version:"1.2.7",template:["<div>",'<div class="cluetip-outer">','<h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3>','<div class="cluetip-inner ui-widget-content ui-cluetip-content"></div>',"</div>",'<div class="cluetip-extra"></div>',"</div>"].join(""),setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{multiple:false,width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,snapToEdge:false,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,delayedClose:50,activation:"hover",clickThrough:true,tracking:false,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(e){return true},onShow:function(e,t){},onHide:function(e,t){},ajaxCache:true,ajaxProcess:function(e){return e},ajaxSettings:{dataType:"html"},debug:false}};var t,n="cluetip ui-widget ui-widget-content ui-cluetip",r={},i=0,s=0;e.fn.attrProp=e.fn.prop||e.fn.attr;e.fn.cluetip=function(o,u){function S(){}function x(t,n){var r=t||"";n=n||"";if(typeof n=="object"){e.each(n,function(e,t){r+="-"+e+"-"+t})}else if(typeof n=="string"){r+=n}return r}function T(t,n,r){var i="",s=n.dropShadow&&n.dropShadowSteps?+n.dropShadowSteps:0;if(e.support.boxShadow){if(s){i="1px 1px "+s+"px rgba(0,0,0,0.5)"}var o=s===0?"0 0 ":"1px 1px ";t.css(e.support.boxShadow,i);return false}var u=t.find(".cluetip-drop-shadow");if(s==u.length){return u}u.remove();var a=[];for(var f=0;f<s;){a[f++]='<div style="top:'+f+"px;left:"+f+'px;"></div>'}r=e(a.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:v-1,opacity:.1}).addClass("cluetip-drop-shadow").prependTo(t);return r}var a,f,l,c,h,p;if(typeof o=="object"){u=o;o=null}if(o=="destroy"){var d=this.data("cluetip");if(d){e(d.selector).remove();e.removeData(this,"title");e.removeData(this,"cluetip");e.removeData(this,"cluetipMoc")}e(document).unbind(".cluetip");return this.unbind(".cluetip")}u=e.extend(true,{},e.cluetip.defaults,u||{});i++;var v,m=e.cluetip.backCompat||!u.multiple?"cluetip":"cluetip-"+i,g="#"+m,y=e.cluetip.backCompat?"#":".",b=e.cluetip.setup.insertionType,w=e.cluetip.setup.insertionElement||"body";b=/appendTo|prependTo|insertBefore|insertAfter/.test(b)?b:"appendTo";a=e(g);if(!a.length){a=e(e.cluetip.template)[b](w).attr("id",m).css({position:"absolute",display:"none"});v=+u.cluezIndex;l=a.find(y+"cluetip-outer").css({position:"relative",zIndex:v});f=a.find(y+"cluetip-inner");c=a.find(y+"cluetip-title");a.bind("mouseenter mouseleave",function(t){e(this).data("entered",t.type==="mouseenter")})}t=e("#cluetip-waitimage");if(!t.length&&u.waitImage){t=e("<div></div>").attr("id","cluetip-waitimage").css({position:"absolute"});t.insertBefore(a).hide()}var E=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0);this.each(function(i){function Y(){return false}function st(e,t){var n=e.status;t.beforeSend(e.xhr,t);if(n=="error"){t[n](e.xhr,e.textStatus)}else if(n=="success"){t[n](e.data,e.textStatus,e.xhr)}t.complete(e.xhr,t.textStatus)}var d=this,m=e(this),b=e.extend(true,{},u,e.metadata?m.metadata():e.meta?m.data():m.data("cluetip")||{}),w=false,S=false,N=null,C=b[b.attribute]||(b.attribute=="href"?m.attr(b.attribute):m.attrProp(b.attribute)||m.attr(b.attribute)),k=b.cluetipClass;v=+b.cluezIndex;m.data("cluetip",{title:d.title,zIndex:v,selector:g});if(b.arrows&&!a.find(".cluetip-arrows").length){a.append('<div class="cluetip-arrows ui-state-default"></div>')}if(!C&&!b.splitTitle&&!o){return true}if(b.local&&b.localPrefix){C=b.localPrefix+C}if(b.local&&b.hideLocal&&C){e(C+":first").hide()}var L=parseInt(b.topOffset,10),A=parseInt(b.leftOffset,10);var O,M,_=isNaN(parseInt(b.height,10))?"auto":/\D/g.test(b.height)?b.height:b.height+"px";var D,P,H,B,j,F,I;var q=parseInt(b.width,10)||275,R=q+E+b.dropShadowSteps,U=this.offsetWidth,z,W,X,V,J;var K;var Q=b.attribute!="title"?m.attr(b.titleAttribute)||"":"";if(b.splitTitle){K=Q.split(b.splitTitle);Q=b.showTitle||K[0]===""?K.shift():""}if(b.escapeTitle){Q=Q.replace(/&/g,"&").replace(/>/g,">").replace(/</g,"<")}var G;m.bind("mouseenter mouseleave",function(e){var t=m.data("cluetip");t.entered=e.type==="entered";m.data("cluetip",t)});var Z=function(n){var p,v,E,T=b.onActivate.call(d,n);if(T===false){return false}S=true;a=e(g).css({position:"absolute"});l=a.find(y+"cluetip-outer");f=a.find(y+"cluetip-inner");c=a.find(y+"cluetip-title");h=a.find(y+"cluetip-arrows");a.removeClass().css({width:q});if(C==m.attr("href")){m.css("cursor",b.cursor)}if(b.hoverClass){m.addClass(b.hoverClass)}P=B=m.offset().top;H=P+m.innerHeight();z=m.offset().left;U=m.innerWidth();if(n.type==focus){V=z+U/2+A;a.css({left:W});F=B+L}else{V=n.pageX;F=n.pageY}if(d.tagName.toLowerCase()!="area"){D=e(document).scrollTop();J=e(window).width()}if(b.positionBy=="fixed"){W=U+z+A;a.css({left:W})}else{W=U>z&&z>R||z+U+R+A>J?z-R-A:U+z+A;if(d.tagName.toLowerCase()=="area"||b.positionBy=="mouse"||U+R>J){if(V+20+R>J){a.addClass("cluetip-"+k);W=V-R-A>=0?V-R-A-parseInt(a.css("marginLeft"),10)+parseInt(f.css("marginRight"),10):V-R/2}else{W=V+A}}p=W<0?n.pageY+L:n.pageY;if(W<0||b.positionBy=="bottomTop"||b.positionBy=="topBottom"){W=V+R/2>J?J/2-R/2:Math.max(V-R/2,0)}}h.css({zIndex:m.data("cluetip").zIndex+1});a.css({left:W,zIndex:m.data("cluetip").zIndex});M=e(window).height();if(o){if(typeof o=="function"){o=o.call(d)}f.html(o);et(p)}else if(K){var N=K.length;f.html(N?K[0]:"");if(N>1){for(var O=1;O<N;O++){f.append('<div class="split-body">'+K[O]+"</div>")}}et(p)}else if(!b.local&&C.indexOf("#")!==0){if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(C)){f.html('<img src="'+C+'" alt="'+Q+'" />');et(p)}else{var _=b.ajaxSettings.beforeSend,j=b.ajaxSettings.error,I=b.ajaxSettings.success,X=b.ajaxSettings.complete;E=x(C,b.ajaxSettings.data);var G={cache:b.ajaxCache,url:C,beforeSend:function(e,n){if(_){_.call(d,e,a,f,n)}l.children().empty();if(b.waitImage){t.css({top:F+20,left:V+20,zIndex:m.data("cluetip").zIndex-1}).show()}},error:function(e,t){if(u.ajaxCache&&!r[E]){r[E]={status:"error",textStatus:t,xhr:e}}if(S){if(j){j.call(d,e,t,a,f)}else{f.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(e,t,n){if(u.ajaxCache&&!r[E]){r[E]={status:"success",data:e,textStatus:t,xhr:n}}w=b.ajaxProcess.call(d,e);if(typeof w=="object"&&w!==null){Q=w.title;w=w.content}if(S){if(I){I.call(d,e,t,a,f)}f.html(w)}},complete:function(n,r){if(X){X.call(d,n,r,a,f)}var i=f[0].getElementsByTagName("img");s=i.length;for(var o=0,u=i.length;o<u;o++){if(i[o].complete){s--}}if(s&&!e.browser.opera){e(i).bind("load.ct error.ct",function(){s--;if(s===0){t.hide();e(i).unbind(".ct");if(S){et(p)}}})}else{t.hide();if(S){et(p)}}}};v=e.extend(true,{},b.ajaxSettings,G);if(r[E]){st(r[E],v)}else{e.ajax(v)}}}else if(b.local){var Y=e(C+(/^#\S+$/.test(C)?"":":eq("+i+")")).clone(true).show();if(b.localIdSuffix){Y.attr("id",Y[0].id+b.localIdSuffix)}f.html(Y);et(p)}};var et=function(t){var r,i,s,o=Q||b.showTitle&&" ",u="",v="",g=false;var y={bottom:function(e){e.appendTo(f)},top:function(e){e.prependTo(f)},title:function(e){e.prependTo(c)}};a.addClass("cluetip-"+k);if(b.truncate){var w=f.text().slice(0,b.truncate)+"...";f.html(w)}if(o){c.show().html(o)}else{c.hide()}if(b.sticky){if(y[b.closePosition]){r=e('<div class="cluetip-close"><a href="#">'+b.closeText+"</a></div>");y[b.closePosition](r);r.bind("click.cluetip",function(){nt();return false})}if(b.mouseOutClose){var E;a.hover(function(){clearTimeout(E);E=null},function(){E=setTimeout(function(){r.trigger("click")},b.delayedClose)});m.hover(function(){clearTimeout(E);E=null},function(){E=setTimeout(function(){r.trigger("click")},b.delayedClose)})}}l.css({zIndex:m.data("cluetip").zIndex,overflow:_=="auto"?"visible":"auto",height:_});O=_=="auto"?Math.max(a.outerHeight(),a.height()):parseInt(_,10);j=B;I=D+M;g=W<V&&Math.max(W,0)+R>V;if(b.positionBy=="fixed"){j=B-b.dropShadowSteps+L}else if(b.positionBy=="topBottom"||b.positionBy=="bottomTop"||g){if(b.positionBy=="topBottom"){if(B+O+L<I&&F-D<O+L){v="bottom"}else{v="top"}}else if(b.positionBy=="bottomTop"||g){if(B+O+L>I&&F-D>O+L){v="top"}else{v="bottom"}}if(b.snapToEdge){if(v=="top"){j=P-O-L}else if(v=="bottom"){j=H+L}}else{if(v=="top"){j=F-O-L}else if(v=="bottom"){j=F+L}}}else if(B+O+L>I){j=O>=M?D:I-O-L}else if(m.css("display")=="block"||d.tagName.toLowerCase()=="area"||b.positionBy=="mouse"){j=t-L}else{j=B-b.dropShadowSteps}if(v===""){v=W<z?"left":"right"}i=" clue-"+v+"-"+k+" cluetip-"+k;if(k=="rounded"){i+=" ui-corner-all"}a.css({top:j+"px"}).attrProp({className:n+i});if(b.arrows){if(/(left|right)/.test(v)){s=a.height()-h.height();u=W>=0&&t>0?B-j-b.dropShadowSteps:0;u=s>u?u:s;u+="px"}h.css({top:u}).show()}else{h.hide()}p=T(a,b);if(p&&p.length){p.hide().css({height:O,width:q,zIndex:m.data("cluetip").zIndex-1}).show()}if(!N){a.hide()}clearTimeout(N);N=null;a[b.fx.open](b.fx.openSpeed||0);if(e.fn.bgiframe){a.bgiframe()}b.onShow.call(d,a,f)};var tt=function(e){S=false;t.hide();if(!b.sticky||/click|toggle/.test(b.activation)){if(b.delayedClose>0){clearTimeout(N);N=null;N=setTimeout(nt,b.delayedClose)}}if(b.hoverClass){m.removeClass(b.hoverClass)}};var nt=function(t){var n=t&&t.data("cluetip")?t:m,r=n.data("cluetip")&&n.data("cluetip").selector,i=r||"div.cluetip",s=e(i),o=s.find(y+"cluetip-inner"),u=s.find(y+"cluetip-arrows");s.hide().removeClass();b.onHide.call(n[0],s,o);if(r){n.removeClass("cluetip-clicked");n.css("cursor","")}if(r&&Q){n.attrProp(b.titleAttribute,Q)}if(b.arrows){u.css({top:""})}};var rt=function(){var e=this;clearTimeout(N);N=setTimeout(function(){var t=m.data("cluetip").entered,n=a.data("entered"),r=false;if(b.mouseOutClose=="both"&&(t||n)){r=true}else if((b.mouseOutClose===true||b.mouseOutClose=="cluetip")&&n){r=true}else if(b.mouseOutClose=="link"&&t){r=true}if(!r){nt.call(e)}},b.delayedClose)};e(document).unbind("hideCluetip.cluetip").bind("hideCluetip.cluetip",function(t){nt(e(t.target))});if(/click|toggle/.test(b.activation)){m.bind("click.cluetip",function(t){if(a.is(":hidden")||!m.is(".cluetip-clicked")){Z(t);e(".cluetip-clicked").removeClass("cluetip-clicked");m.addClass("cluetip-clicked")}else{tt(t)}return false})}else if(b.activation=="focus"){m.bind("focus.cluetip",function(e){m.attrProp("title","");Z(e)});m.bind("blur.cluetip",function(e){m.attrProp("title",m.data("cluetip").title);tt(e)})}else{m[b.clickThrough?"unbind":"bind"]("click.cluetip",Y);var it=function(e){if(b.tracking){var t=W-e.pageX;var n=j?j-e.pageY:B-e.pageY;m.bind("mousemove.cluetip",function(e){a.css({left:e.pageX+t,top:e.pageY+n})})}};if(e.fn.hoverIntent&&b.hoverIntent){m.hoverIntent({sensitivity:b.hoverIntent.sensitivity,interval:b.hoverIntent.interval,over:function(e){Z(e);it(e)},timeout:b.hoverIntent.timeout,out:function(e){tt(e);m.unbind("mousemove.cluetip")}})}else{m.bind("mouseenter.cluetip",function(e){Z(e);it(e)}).bind("mouseleave.cluetip",function(e){tt(e);m.unbind("mousemove.cluetip")})}m.bind("mouseover.cluetip",function(e){m.attrProp("title","")}).bind("mouseleave.cluetip",function(e){m.attrProp("title",m.data("cluetip").title)})}});return this};(function(){e.support=e.support||{};var t=document.createElement("div"),n=t.style,r=["boxShadow"],i=["moz","Moz","webkit","o"];for(var s=0,o=r.length;s<o;s++){var u=r[s],a=u.charAt(0).toUpperCase()+u.slice(1);if(typeof n[u]!=="undefined"){e.support[u]=u}else{for(var f=0,l=i.length;f<l;f++){if(typeof n[i[f]+a]!=="undefined"){e.support[u]=i[f]+a;break}}}}t=null})();e.fn.cluetip.defaults=e.cluetip.defaults})(jQuery)